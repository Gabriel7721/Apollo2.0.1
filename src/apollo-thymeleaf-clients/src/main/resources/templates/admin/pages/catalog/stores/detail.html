<th:block th:fragment="styles">
  <link th:href="@{/plugins/custom/datatables/datatables.bundle.css}" rel="stylesheet" type="text/css" />
</th:block>

<th:block th:fragment="scripts">
  <script th:src="@{/plugins/custom/datatables/datatables.bundle.js}"></script>
  <script th:src="@{/js/custom/catalog/categories.js}"></script>
  <script th:src="@{/plugins/custom/fslightbox/fslightbox.bundle.js}"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var overlayLinks = document.querySelectorAll('.overlay');

      overlayLinks.forEach(function (link) {
        var imageUrl = link.getAttribute('href');

        var divElement = link.querySelector('.overlay-wrapper');

        if (divElement && imageUrl) {
          divElement.style.backgroundImage = 'url(' + imageUrl + ')';
        }
      });
    });
  </script>
</th:block>

<th:block th:fragment="content">

  <div class="d-flex flex-column flex-row-fluid gap-7 gap-lg-10">
    <ul class="nav nav-custom nav-tabs nav-line-tabs nav-line-tabs-2x border-0 fs-4 fw-semibold mb-n2" role="tablist">
      <li class="nav-item" role="presentation">
        <a class="nav-link text-active-primary pb-4 active" data-bs-toggle="tab"
          href="#kt_ecommerce_add_product_general" aria-selected="true" role="tab">General</a>
      </li>

      <li class="nav-item" role="presentation">
        <a class="nav-link text-active-primary pb-4 " aria-selected="false" data-bs-toggle="tab"
          href="#kt_ecommerce_add_product_advanced" role="tab" tabindex="-1">Categories Listing</a>
      </li>

    </ul>
    <div class="tab-content">
      <div class="tab-pane fade active show" id="kt_ecommerce_add_product_general" role="tab-panel">
        <div class="d-flex flex-column gap-7 gap-lg-10">

          <div class="card card-flush py-4">
            <div class="card-header">
              <div class="card-title">
                <h2>Home Image</h2>
              </div>
            </div>
            <div class="card-body pt-0">
              <div class="mb-10 fv-row fv-plugins-icon-container">

                <div class="card-xl-stretch me-md-6">
                  <a class="d-block overlay mb-4" data-fslightbox="lightbox-home-image" th:href="${store.homeImage}">
                    <div
                      class="overlay-wrapper bgi-no-repeat bgi-position-center bgi-size-cover card-rounded min-h-175px">
                    </div>
                  </a>
                </div>

              </div>
            </div>
          </div>

          <div class="card card-flush py-4">
            <div class="card-header">
              <div class="card-title">
                <h2>Deal Image</h2>
              </div>
            </div>
            <div class="card-body pt-0">
              <div class="mb-10 fv-row fv-plugins-icon-container">

                <div class="card-xl-stretch me-md-6">
                  <a class="d-block overlay mb-4" data-fslightbox="lightbox-home-image" th:href="${store.dealsImage}">
                    <div
                      class="overlay-wrapper bgi-no-repeat bgi-position-center bgi-size-cover card-rounded min-h-175px">
                    </div>
                  </a>
                </div>

              </div>
            </div>
          </div>

          <div class="card card-flush py-4">
            <div class="card-header">
              <div class="card-title">
                <h2>Deal Square Image</h2>
              </div>
            </div>
            <div class="card-body pt-0">
              <div class="mb-10 fv-row fv-plugins-icon-container">

                <div class="card-xl-stretch me-md-6">
                  <a class="d-block overlay mb-4" data-fslightbox="lightbox-home-image"
                    th:href="${store.dealsSquareImage}">
                    <div
                      class="overlay-wrapper bgi-no-repeat bgi-position-center bgi-size-cover card-rounded min-h-175px">
                    </div>
                  </a>
                </div>

              </div>
            </div>
          </div>

          <div class="card card-flush py-4">
            <div class="card-header">
              <div class="card-title">
                <h2>Interactive Image</h2>
              </div>
            </div>
            <div class="card-body pt-0">
              <div class="mb-10 fv-row fv-plugins-icon-container">

                <div class="card-xl-stretch me-md-6">
                  <a class="d-block overlay mb-4" data-fslightbox="lightbox-home-image"
                    th:href="${store.interactiveImage}">
                    <div
                      class="overlay-wrapper bgi-no-repeat bgi-position-center bgi-size-cover card-rounded min-h-175px">
                    </div>
                  </a>
                </div>

              </div>
            </div>
          </div>

          <div class="card card-flush py-4">
            <div class="card-header">
              <div class="card-title">
                <h2>Logo</h2>
              </div>
            </div>
            <div class="card-body pt-0">
              <div class="mb-10 fv-row fv-plugins-icon-container">

                <div class="card-xl-stretch me-md-6">
                  <a class="d-block overlay mb-4" data-fslightbox="lightbox-home-image" th:href="${store.logo}">
                    <div
                      class="overlay-wrapper bgi-no-repeat bgi-position-center bgi-size-cover card-rounded min-h-175px">
                    </div>
                  </a>
                </div>

              </div>
            </div>
          </div>


        </div>
      </div>

      <div class="tab-pane fade" id="kt_ecommerce_add_product_advanced" role="tab-panel">
        <div class="d-flex flex-column gap-7 gap-lg-10">
          <div class="card card-flush">
            <div class="card-header align-items-center py-5 gap-2 gap-md-5">
              <div class="card-title">
                <div class="d-flex align-items-center position-relative my-1">
                  <i class="ki-duotone ki-magnifier fs-3 position-absolute ms-4">
                    <span class="path1"></span>
                    <span class="path2"></span>
                  </i>
                  <input type="text" data-kt-ecommerce-category-filter="search"
                    class="form-control form-control-solid w-250px ps-12" placeholder="Search Store" />
                </div>
              </div>

              <div class="card-toolbar">
                <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                  data-bs-target="#modal_add_stores_categories">
                  <i class="ki-duotone ki-plus fs-2"></i> Add Category
                </button>
              </div>
            </div>

            <div class="card-body pt-0">

              <table class="table align-middle table-row-dashed fs-6 gy-5" id="kt_ecommerce_category_table">
                <thead>
                  <tr class="text-start text-gray-500 fw-bold fs-7 text-uppercase gs-0">
                    <th class="w-10px pe-2"></th>
                    <th class="min-w-250px">Category</th>
                    <th class="min-w-150px"></th>
                    <th class="text-end min-w-70px">Actions</th>
                  </tr>
                </thead>
                <tbody class="fw-semibold text-gray-600">
                  <tr th:each="i : ${categories}">
                    <td></td>
                    <td>
                      <div class="d-flex">
                        <div class="ms-5">
                          <a th:href="@{/dashboard/catalog/stores/{id}(id=${i.id})}"
                            class="text-gray-800 text-hover-primary fs-5 fw-bold mb-1"
                            data-kt-ecommerce-category-filter="category_name" th:text="${i.name}"></a>
                        </div>
                      </div>
                    </td>
                    <td>

                    </td>
                    <td class="text-end">
                      <a href="#" class="btn btn-sm btn-light btn-active-light-primary btn-flex btn-center"
                        data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">
                        Actions
                        <i class="ki-duotone ki-down fs-5 ms-1"></i> </a>
                      <div
                        class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-semibold fs-7 w-125px py-4"
                        data-kt-menu="true">
                        <div class="menu-item px-3">
                          <a th:href="@{/dashboard/catalog/stores/{id}/edit(id=${i.id})}" class="menu-link px-3">
                            Edit
                          </a>
                        </div>

                        <div class="menu-item px-3">
                          <a href="#" class="menu-link px-3" data-kt-ecommerce-category-filter="delete_row"
                            th:data-url="@{/dashboard/catalog/stores/{id}/delete(id=${i.id})}">
                            Delete
                          </a>
                        </div>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="modal_add_stores_categories" data-bs-backdrop="static" data-bs-keyboard="false"
    tabindex="-1" aria-labelledby="modal_add_stores_categories_Label" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="modal_add_stores_categories_Label">Modal title</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">

          <div class="fv-row mb-7 fv-plugins-icon-container fv-plugins-bootstrap5-row-valid">
            <label class="required fw-semibold fs-6 mb-2">Name</label>
            <input type="text" name="name" class="form-control form-control-solid mb-3 mb-lg-0"
              placeholder="Name">
            <div class="fv-plugins-message-container fv-plugins-message-container--enabled invalid-feedback"></div>
          </div>

          <form th:action="@{/dashboard/catalog/stores/create-store-categories}" th:object="${storeCategoryDTO}" method="post">
            <input type="hidden" th:field="*{storeId}">

            <label for="name">Name:</label>
            <input type="text" id="name" th:field="*{name}" required>

            <label for="heroImage">Hero Image URL:</label>
            <input type="text" id="heroImage" th:field="*{heroImage}">

            <label for="squareImage">Square Image URL:</label>
            <input type="text" id="squareImage" th:field="*{squareImage}">

            <button type="submit">Create Category</button>
        </form>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Understood</button>
        </div>
      </div>
    </div>
  </div>

</th:block>